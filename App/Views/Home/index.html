{% extends "layout/appLayout.html" %}

{% block title %} Home / Twitter {%endblock%}


{% block content %} 

<main class="col-10 p-0 twitter-border-end main-part">

    <nav class="navbar twitter-border-bottom p-0 position-sticky top-0" id="navbar-2">
        <div class="container-fluid p-0 d-flex flex-column nav-2-container">
          <div class="align-self-start d-md-none">
            <a class="navbar-brand d-md-none" href="#">Home</a>
          </div>
          <div class="container grid-container p-0">
            <div class="row h-100 ">
              <div class="col pe-0 d-flex justify-content-center align-content-center">
                <a href="#firstlink" class="nav2-link d-flex justify-content-center align-items-center w-100 h-100" onclick="clickLink(this)" id="firstlink">For you</a>
              </div>
              <div class="col d-flex justify-content-center">
                <a href="#" class="nav2-link  d-flex justify-content-center align-items-center w-100 h-100" onclick="clickLink(this)">Following</a>
              </div>
            </div>
          </div>
          
        </div>
      </nav>

    
    <div class="happeningContainer twitter-border-bottom pt-3 pb-3 ps-3 pe-3">
      <form class="whatIsHappening row" id="myform" enctype="multipart/form-data">
        <div class="background-profile p-0 ms-3">
          <img src="photos/user.png" class="w-100 h-100" alt="aa">
        </div>
        <div class="col-10 row">
            <div class="tweet-text-container col-12">
              <textarea class="border-0 h-auto" name="tweetText" id="tweetText" placeholder="What is happening?!"></textarea>
            </div>
            <div class="options col-12 row">
              <div class="col-11">
                <input type="file" id="fileInput" class="d-none" name="image">
                <label for="fileInput" class= "media-label me-3">
                  <svg viewBox="0 0 24 24" aria-hidden="true" class="photo r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-1plcrui r-lrvibr r-z80fyv r-19wmn03">
                      <g>
                        <path class="alb" d="M3 5.5C3 4.119 4.119 3 5.5 3h13C19.881 3 21 4.119 21 5.5v13c0 1.381-1.119 2.5-2.5 2.5h-13C4.119 21 3 19.881 3 18.5v-13zM5.5 5c-.276 0-.5.224-.5.5v9.086l3-3 3 3 5-5 3 3V5.5c0-.276-.224-.5-.5-.5h-13zM19 15.414l-3-3-5 5-3-3-3 3V18.5c0 .276.224.5.5.5h13c.276 0 .5-.224.5-.5v-3.086zM9.75 7C8.784 7 8 7.784 8 8.75s.784 1.75 1.75 1.75 1.75-.784 1.75-1.75S10.716 7 9.75 7z"></path>
                      </g>
                  </svg>
                </label>
  
                <svg viewBox="0 0 24 24" aria-hidden="true" class="photo me-3 r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-1plcrui r-lrvibr r-z80fyv r-19wmn03" style="color: rgb(29, 155, 240);"><g><path class="alb" d="M3 5.5C3 4.119 4.12 3 5.5 3h13C19.88 3 21 4.119 21 5.5v13c0 1.381-1.12 2.5-2.5 2.5h-13C4.12 21 3 19.881 3 18.5v-13zM5.5 5c-.28 0-.5.224-.5.5v13c0 .276.22.5.5.5h13c.28 0 .5-.224.5-.5v-13c0-.276-.22-.5-.5-.5h-13zM18 10.711V9.25h-3.74v5.5h1.44v-1.719h1.7V11.57h-1.7v-.859H18zM11.79 9.25h1.44v5.5h-1.44v-5.5zm-3.07 1.375c.34 0 .77.172 1.02.43l1.03-.86c-.51-.601-1.28-.945-2.05-.945C7.19 9.25 6 10.453 6 12s1.19 2.75 2.72 2.75c.85 0 1.54-.344 2.05-.945v-2.149H8.38v1.032H9.4v.515c-.17.086-.42.172-.68.172-.76 0-1.36-.602-1.36-1.375 0-.688.6-1.375 1.36-1.375z"></path></g></svg>
                    
                <svg viewBox="0 0 24 24" aria-hidden="true" class="photo r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-1plcrui r-lrvibr r-z80fyv r-19wmn03" style="color: rgb(29, 155, 240);"><g><path class="alb" d="M8 9.5C8 8.119 8.672 7 9.5 7S11 8.119 11 9.5 10.328 12 9.5 12 8 10.881 8 9.5zm6.5 2.5c.828 0 1.5-1.119 1.5-2.5S15.328 7 14.5 7 13 8.119 13 9.5s.672 2.5 1.5 2.5zM12 16c-2.224 0-3.021-2.227-3.051-2.316l-1.897.633c.05.15 1.271 3.684 4.949 3.684s4.898-3.533 4.949-3.684l-1.896-.638c-.033.095-.83 2.322-3.053 2.322zm10.25-4.001c0 5.652-4.598 10.25-10.25 10.25S1.75 17.652 1.75 12 6.348 1.75 12 1.75 22.25 6.348 22.25 12zm-2 0c0-4.549-3.701-8.25-8.25-8.25S3.75 7.451 3.75 12s3.701 8.25 8.25 8.25 8.25-3.701 8.25-8.25z"></path></g></svg>
              </div>

              <div class="col-1">
                <input type="button" value="Post" name="post" id="post-button" class="p-button btn btn-primary rounded-5">
              </div>

              

            </div>
            
        </div>
      </form>
    </div>  

    <div class="main-part-wrapper">
      <div class="tweets" id="tweets">

        <div class="tweet-container twitter-border-bottom px-3 py-2">
          <div class="post row p-0 m-0">
            <div class="profile-image-container p-0">
              <div class="profile-image-wrapper">
                <img src="photos/user.png" alt="" class="w-100 h-100">
              </div>
            
            </div>
            <div class="tweet-content col-11 row p-0 m-0">
              <div class="col-12 user-info d-flex gap-2">
                <a href="#elon" class="text-decoration-none">
                  <div class="name-text-container">
                    <span>Elon Musk</span>
                  </div>
                </a>

                <a href="#elon" class="text-decoration-none">
                  <div class="username-text-container">
                    <span>@elonmusk</span>
                  </div>
                </a>

                <div class="created-at">
                  <span>6h</span>
                </div>
              </div>

              <div class="col-12 gy-1">
                <div class="tweet-text-container">
                  <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aspernatur minus deleniti veritatis obcaecati itaque laudantium beatae. Obcaecati est deserunt rem, nam quas sit facilis vel provident, porro modi nostrum voluptates necessitatibus fugit aperiam iste eius ullam dolorum non! Ullam, sint adipisci a cupiditate impedit officiis at, aliquid vitae accusantium dolores eius. Quibusdam, fugit? Illo vero molestiae sed voluptatum deleniti, impedit, labore repellendus voluptatem temporibus consectetur, corrupti tenetur omnis rem sint maiores iure. Reiciendis possimus aperiam laudantium, nihil necessitatibus dolor magnam.</span>
                </div>
              </div>

              <div class="col-12 gy-3">
                <div class="replyRetweet d-flex gap-5">
                  <div class="d-flex gap-1 align-content-center">
                    <button class="replyButton">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>
                  <div class="d-flex gap-1">
                    <button class="retweetButton">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>

                  <div class="d-flex gap-1">
                    <button class="likeButton align-self-center">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>
                  
                </div>
              </div>
            </div>

          </div>
        </div>


        <div class="tweet-container twitter-border-bottom px-3 py-2">
          <div class="image-post row p-0 m-0">
            <div class="profile-image-container p-0">
              <div class="profile-image-wrapper">
                <img src="photos/user.png" alt="" class="w-100 h-100">
              </div>
            
            </div>
            <div class="tweet-content col-11 row p-0 m-0">
              <div class="col-12 user-info d-flex gap-2">
                <a href="#elon" class="text-decoration-none">
                  <div class="name-text-container">
                    <span>Elon Musk</span>
                  </div>
                </a>

                <a href="#elon" class="text-decoration-none">
                  <div class="username-text-container">
                    <span>@elonmusk</span>
                  </div>
                </a>

                <div class="created-at">
                  <span>6h</span>
                </div>
              </div>

              <div class="col-12 gy-1">
                <div class="tweet-text-container">
                  <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aspernatur minus deleniti veritatis obcaecati itaque laudantium beatae. Obcaecati est deserunt rem, nam quas sit facilis vel provident, porro modi nostrum voluptates necessitatibus fugit aperiam iste eius ullam dolorum non! Ullam, sint adipisci a cupiditate impedit officiis at, aliquid vitae accusantium dolores eius. Quibusdam, fugit? Illo vero molestiae sed voluptatum deleniti, impedit, labore repellendus voluptatem temporibus consectetur, corrupti tenetur omnis rem sint maiores iure. Reiciendis possimus aperiam laudantium, nihil necessitatibus dolor magnam.</span>
                </div>
              </div>

              <div class="col-12 gy-2">
                <img src="photos/rocket.png" class="img-fluid" alt="">
              </div>

              <div class="col-12 gy-3">
                <div class="replyRetweet d-flex gap-5">
                  <div class="d-flex gap-1 align-content-center">
                    <button class="replyButton">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>
                  <div class="d-flex gap-1">
                    <button class="retweetButton">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>

                  <div class="d-flex gap-1">
                    <button class="likeButton align-self-center">
                      <svg class="tweets-button-style" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z"></path></g></svg>
                    </button>
                    <span>11K</span>
                  </div>
                  
                </div>
              </div>
            </div>

          </div>
        </div>



        


    </div>

</main>

<script src="js/addtweet.js"></script>
<script>

  


   const postButton = document.getElementById('post-button');
   postButton.addEventListener('click' , addTweet);

   

    async function getTweets() {
        try {
          const endpoint = '/get-tweets';
          const request = await fetch(endpoint);
          const tweets = await request.json();

          console.log(tweets);
          showTweets(tweets);
          

        } catch (error) {
          console.log(error);
        }

    }

    async function like() {
        const tweet = this.parentElement.parentElement
                        .parentElement.parentElement
                        .parentElement.parentElement;
       
        const tweetId = tweet.id;
        const id = tweetId.split('tweet-').join('');
        const num_likes =  parseInt(this.nextSibling.innerHTML);
        
        
        try {

          const endpoint = `/tweet/${id}`;
          const request = await fetch(endpoint, {
            method: 'POST'
          });

          const response = await request.json();

         manageLikes(response, num_likes, this);
          
        } catch (error) {
          console.log(error);
        }


    }

    async function isLiked(tweet) {

      const endpoint = `/api/tweet/${tweet.id}`;
      console.log(tweet.id);
      const request = await fetch(endpoint);
      const response = await request.json();

      if(response.result == 'true') {
        return true;
      }
      else {
        return false;
      }

    }


    function manageLikes(response , num_likes, button) {
      if(response.result == 'liked') {
       button.nextSibling.innerHTML =  num_likes + 1;
       button.firstChild.style.fill = 'red';
      }
      else {
       button.nextSibling.innerHTML =  num_likes - 1;
       button.firstChild.style.fill = 'rgb(83, 100, 113)';
      }
    }

    function reply() {
      // TODO
    }

    function retweet() {
      //TODO
    }

    function showImagePost(tweet) {
      const tweetsContainer = document.getElementById('tweets');

      const tweetContainer = document.createElement('div');
      tweetContainer.classList.add('tweet-container', 'twitter-border-bottom', 'px-3', 'py-2');
      tweetContainer.setAttribute('id', `tweet-${tweet.id}`);

      // Create the image post row div 
      const postImageRow = document.createElement('div');
      postImageRow.classList.add('image-post', 'row', 'p-0', 'm-0');
      tweetContainer.appendChild(postImageRow);

      // Create the profile image container div
      const profileImageContainer = document.createElement('div');
      profileImageContainer.classList.add('profile-image-container', 'p-0');
      postImageRow.appendChild(profileImageContainer);

       // Create the profile image wrapper div
       const profileImageWrapper = document.createElement('div');
       profileImageWrapper.classList.add('profile-image-wrapper');
       profileImageContainer.appendChild(profileImageWrapper);


       // Create the image element
       const profileImage = document.createElement('img');
       profileImage.src = 'photos/user.png';
       profileImage.alt = '';
       profileImage.classList.add('w-100', 'h-100');
       profileImageWrapper.appendChild(profileImage);


       // Create the tweet content container
       const tweetContent = document.createElement('div');
       tweetContent.classList.add('tweet-content', 'col-11', 'row', 'p-0', 'm-0');
       postImageRow.appendChild(tweetContent);


       // Create the user info row
       const userInfo = document.createElement('div');
       userInfo.classList.add('col-12', 'user-info', 'd-flex', 'gap-2');
       tweetContent.appendChild(userInfo);


       // Create the name and username links
       const nameLink = document.createElement('a');
       nameLink.href = '#elon';
       nameLink.classList.add('text-decoration-none');
       userInfo.appendChild(nameLink);


       const nameTextContainer = document.createElement('div');
       nameTextContainer.classList.add('name-text-container');
       nameLink.appendChild(nameTextContainer);

       const nameText = document.createElement('span');
       nameText.textContent = tweet.user.firstname + " " + tweet.user.lastname;
       nameTextContainer.appendChild(nameText);


       const usernameLink = document.createElement('a');
        usernameLink.href = '#elon';
        usernameLink.classList.add('text-decoration-none');
        userInfo.appendChild(usernameLink);

        const usernameTextContainer = document.createElement('div');
        usernameTextContainer.classList.add('username-text-container');
        usernameLink.appendChild(usernameTextContainer);

        const usernameText = document.createElement('span');
        usernameText.textContent = tweet.user.username;
        usernameTextContainer.appendChild(usernameText);


         // Create the created-at span
        const createdAt = document.createElement('div');
        createdAt.classList.add('created-at');
        const createdAtText = document.createElement('span');
        createdAtText.textContent = '6h';
        createdAt.appendChild(createdAtText);
        userInfo.appendChild(createdAt);


        // Create the tweet text container
        const tweetTextContainer = document.createElement('div');
        tweetTextContainer.classList.add('col-12', 'gy-1');
        tweetContent.appendChild(tweetTextContainer);

        const tweetTextInner = document.createElement('div');
        tweetTextInner.classList.add('tweet-text-container');
        tweetTextContainer.appendChild(tweetTextInner);


        const tweetText = document.createElement('span');
        tweetText.textContent = tweet.tweetText;
        tweetTextInner.appendChild(tweetText);


        const imgContainer = document.createElement('div');
        imgContainer.classList.add('col-12', 'gy-2');
        tweetContent.appendChild(imgContainer);

        const postImg = document.createElement('img');
        postImg.src = `uploads/${tweet.tweetImageUrl}`;
        postImg.classList.add('img-fluid'); 
        imgContainer.appendChild(postImg);



         // Create the reply/retweet/like container
         const interactionContainer = document.createElement('div');
        interactionContainer.classList.add('col-12', 'gy-3');
        tweetContent.appendChild(interactionContainer);

        const replyRetweetContainer = document.createElement('div');
        replyRetweetContainer.classList.add('replyRetweet', 'd-flex', 'gap-5');
        interactionContainer.appendChild(replyRetweetContainer);



        const replyButton = createButtonWithIcon(
          'replyButton',
          'M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z',
          '11K'
        );
        replyRetweetContainer.appendChild(replyButton);

        // Create retweet button
        const retweetButton = createButtonWithIcon(
          'retweetButton',
          'M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z',
          '11K'
        );
        replyRetweetContainer.appendChild(retweetButton);

        // Create like button
        const likeButton = createButtonWithIcon(
          'likeButton',
          'M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z',
          tweet.likes.length
        );

        isLiked(tweet).then(
          (response) => {
            if(response) {
              likeButton.firstChild.firstChild.style.fill = 'red';
            }
           
          }
        );
        replyRetweetContainer.appendChild(likeButton);

       
        tweetsContainer.prepend(tweetContainer);



    }


    function showPost(tweet) {
      const tweetsContainer = document.getElementById('tweets');

      const tweetContainer = document.createElement('div');
      tweetContainer.classList.add('tweet-container', 'twitter-border-bottom', 'px-3', 'py-2');
      tweetContainer.setAttribute('id', `tweet-${tweet.id}`);

      // Create the post row div
      const postRow = document.createElement('div');
        postRow.classList.add('post', 'row', 'p-0', 'm-0');
        tweetContainer.appendChild(postRow);


         // Create the profile image container div
        const profileImageContainer = document.createElement('div');
        profileImageContainer.classList.add('profile-image-container', 'p-0');
        postRow.appendChild(profileImageContainer);

        // Create the profile image wrapper div
        const profileImageWrapper = document.createElement('div');
        profileImageWrapper.classList.add('profile-image-wrapper');
        profileImageContainer.appendChild(profileImageWrapper);

        // Create the image element
        const profileImage = document.createElement('img');
        profileImage.src = 'photos/user.png';
        profileImage.alt = '';
        profileImage.classList.add('w-100', 'h-100');
        profileImageWrapper.appendChild(profileImage);

        // Create the tweet content container
        const tweetContent = document.createElement('div');
        tweetContent.classList.add('tweet-content', 'col-11', 'row', 'p-0', 'm-0');
        postRow.appendChild(tweetContent);

        // Create the user info row
        const userInfo = document.createElement('div');
        userInfo.classList.add('col-12', 'user-info', 'd-flex', 'gap-2');
        tweetContent.appendChild(userInfo);

        // Create the name and username links
        const nameLink = document.createElement('a');
        nameLink.href = '#elon';
        nameLink.classList.add('text-decoration-none');
        userInfo.appendChild(nameLink);

        const nameTextContainer = document.createElement('div');
        nameTextContainer.classList.add('name-text-container');
        nameLink.appendChild(nameTextContainer);

        const nameText = document.createElement('span');
        nameText.textContent = tweet.user.firstname + " " + tweet.user.lastname;
        nameTextContainer.appendChild(nameText);

        const usernameLink = document.createElement('a');
        usernameLink.href = '#elon';
        usernameLink.classList.add('text-decoration-none');
        userInfo.appendChild(usernameLink);

        const usernameTextContainer = document.createElement('div');
        usernameTextContainer.classList.add('username-text-container');
        usernameLink.appendChild(usernameTextContainer);

        const usernameText = document.createElement('span');
        usernameText.textContent = tweet.user.username;
        usernameTextContainer.appendChild(usernameText);

        // Create the created-at span
        const createdAt = document.createElement('div');
        createdAt.classList.add('created-at');
        const createdAtText = document.createElement('span');
        createdAtText.textContent = '6h';
        createdAt.appendChild(createdAtText);
        userInfo.appendChild(createdAt);

        // Create the tweet text container
        const tweetTextContainer = document.createElement('div');
        tweetTextContainer.classList.add('col-12', 'gy-1');
        tweetContent.appendChild(tweetTextContainer);

        const tweetTextInner = document.createElement('div');
        tweetTextInner.classList.add('tweet-text-container');
        tweetTextContainer.appendChild(tweetTextInner);

        const tweetText = document.createElement('span');
        tweetText.textContent = tweet.tweetText;
        tweetTextInner.appendChild(tweetText);

        // Create the reply/retweet/like container
        const interactionContainer = document.createElement('div');
        interactionContainer.classList.add('col-12', 'gy-3');
        tweetContent.appendChild(interactionContainer);

        const replyRetweetContainer = document.createElement('div');
        replyRetweetContainer.classList.add('replyRetweet', 'd-flex', 'gap-5');
        interactionContainer.appendChild(replyRetweetContainer);



        const replyButton = createButtonWithIcon(
          'replyButton',
          'M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z',
          '11K'
        );
        replyRetweetContainer.appendChild(replyButton);

        // Create retweet button
        const retweetButton = createButtonWithIcon(
          'retweetButton',
          'M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z',
          '11K'
        );
        replyRetweetContainer.appendChild(retweetButton);

        // Create like button
        const likeButton = createButtonWithIcon(
          'likeButton',
          'M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z',
          tweet.likes.length
        );

        isLiked(tweet).then(
          (response) => {
            if(response) {
              likeButton.firstChild.firstChild.style.fill = 'red';
            }
           
          }
        );
        
        replyRetweetContainer.appendChild(likeButton);

        //tweetsContainer.appendChild(tweetContainer);
        tweetsContainer.prepend(tweetContainer);

    }

    

    function createButtonWithIcon(buttonClass, svgPath, count) {
        const buttonWrapper = document.createElement('div');
        buttonWrapper.classList.add('d-flex', 'gap-1', 'align-content-center');

        const button = document.createElement('button');
        button.classList.add(buttonClass);

        if(buttonClass == 'replyButton') {
          button.addEventListener('click', reply);
        }
        else if (buttonClass == 'retweetButton') {
          button.addEventListener('click', retweet);
        }
        else {
          button.addEventListener('click', like);
        }

        buttonWrapper.appendChild(button);

        const svgIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svgIcon.classList.add('tweets-button-style');
        svgIcon.setAttribute('viewBox', '0 0 24 24');
        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', svgPath);
        g.appendChild(path);
        svgIcon.appendChild(g);
        button.appendChild(svgIcon);


        const span = document.createElement('span');
        span.textContent = count;
        buttonWrapper.appendChild(span);

        return buttonWrapper;
    }


    function showTweets(tweets) {
      tweets.forEach(tweet => {
        if(tweet.tweetImageUrl === null) {
          showPost(tweet);
        }
        else {
          showImagePost(tweet);
        }
      
      });
    }


  window.onload = function() {
      getTweets();
  }

</script>



{%endblock%}